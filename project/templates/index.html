{% extends 'base.html' %}

{% block title %}Welcome{% endblock %}

{% block content %}

          <!--Period filter change-->
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-2 py-20">
            <div class="flex justify-between items-center m-6">
              <div class="text-sm font-semibold text-gray-900">
              </div>


              <div>
              <!-- Date Filter Input -->
              <input type="date" id="dateFilter"
                class="px-4 shadow-lg border border-gray-300 rounded focus:outline-none focus:border-indigo-500 focus:shadow-outline-indigo" 
                onchange="fetchData()">
              </div>
            </div> 

            <div class="flex justify-between">
              <div class="flex space-x-2 mb-10">
                  <!-- Sensor selection dropdown -->
                  <div id="sensor1div">
                    <label for="sensor1" class="block text-sm font-medium text-gray-700">Sensor ID:</label>
                    <select id="sensor1" name="sensor1" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                    onchange="sensorIdChanged()">
                      {% for sensor_id in sensor_ids %}
                        <option value="{{ sensor_id }}">{{ sensor_id }}</option>
                        {% endfor %}
                    </select>
                  </div>
                  
                  <!-- Second sensor dropdown, hidden by default -->
                  <div id="sensor2div" class="hidden">
                    <label for="sensor2" class="block text-sm font-medium text-gray-700">Sensor ID 2:</label>
                    <select id="sensor2" name="sensor2" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                    onchange="sensorIdChanged()">
                      {% for sensor_id in sensor_ids %}
                          <option value="{{ sensor_id }}">{{ sensor_id }}</option>
                      {% endfor %}
                    </select>
                </div>
              </div>
              <div>
                <!-- Toggle for comparing two sensors -->
                <div class="flex items-center h-5">
                  <input id="compareTwoSensors" type="checkbox" class="focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 rounded" onchange="toggleSensorComparison(this)">
                  <label for="compareTwoSensors" class="ml-2 block text-sm text-gray-900">
                      Compare two sensors
                  </label>
                </div>
                  <!-- Checkbox for comparing against average trend -->
                <div class="flex items-center h-5">
                  <input id="compareAverageTrend" name="compareAverageTrend" type="checkbox" class="focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 rounded" onchange="toggleCompareAverageTrend(this)" >
                  <label for="compareAverageTrend" class="ml-2 block text-sm text-gray-900">
                      Compare against average trend
                  </label>
                </div>
              </div>
            </div>


          <div class="flex p-5 gap-4 bg-white">

            <!-- Table-->
            <div class="bg-white p-6 rounded-2xl shadow-lg">
                <!-- <div class="font-bold text-lg mb-4">INFO</div> -->
                <table class="table-auto w-full border-collapse border border-gray-300">
                  <tbody class="text-sm">
                    <!--INFO Header-->
                    <tr>
                      <td class="px-4 py-2 font-bold">INFO</td>
                    </tr>
                    <tr class="bg-gray-100">
                      <td class="px-4 py-2">Device Name</td>
                      <td class="px-4 py-2">Zephyr</td>
                    </tr>
                    <tr>
                      <td class="px-4 py-2">ID</td>
                      <td class="px-4 py-2">24</td>
                    </tr>
                    <tr class="bg-gray-100">
                      <td class="px-4 py-2">Last recorded</td>
                      <td class="px-4 py-2">2 days ago</td>
                    </tr>
                    <!-- <tr>
                      <td class="px-4 py-2">Aggregated missing ticks</td>
                      <td class="px-4 py-2">6 mins</td>
                    </tr>
                    <tr> -->
                      <td class="px-4 py-2">NO2</td>
                      <td class="px-4 py-2">100</td>
                    </tr>
                    <tr>
                      <td class="px-4 py-2">PM2.5</td>
                      <td class="px-4 py-2">199</td>
                    </tr>
                    <tr>
                      <td class="px-4 py-2">PM10</td>
                      <td class="px-4 py-2">110</td>
                    </tr>
                  </tbody>
                </table>
              </div>
          <!-- Card container -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 lg:pt-20 gap-6" id="allCharts">
                <!-- <div class="flex space-x-4"> -->
            <!-- First card -->
            <div class="bg-[#f2c101] text-white rounded-2xl shadow-lg overflow-hidden flex flex-col p-6 space-y-4 w-60 h-44">
              <!-- <div class="text-xs">Average index for the city</div> -->
              <div class="font-bold text-4xl">199 <span class="text-lg">Unhealthy AQI</span></div>
              <div class="flex justify-between text-xs">
                <div class="text-center">
                  <div>Dominant pollutant</div>
                  <div>☀️ PM 2.5</div>
                </div>
              </div>
            </div>
            
            <!-- Second card -->
            <div class="bg-[#90d41c] text-white rounded-2xl shadow-lg overflow-hidden flex flex-col p-6 space-y-4 w-60 h-44">
              <div class="text-xs">The lowest average pollution</div>
              <div class="font-bold text-4xl">44 <span class="text-lg">Healthy AQI</span></div>
              <div class="text-xs text-center">
                <!-- <div>Cleanzone Model 32</div> -->
              </div>
            </div>
        
            <!-- Third card -->
            <div class="bg-[#e05404] text-white rounded-2xl shadow-lg overflow-hidden flex flex-col p-6 space-y-4 w-60 h-44">
              <div class="text-xs">The highest average pollution</div>
              <div class="font-bold text-4xl">311 <span class="text-lg">Hazardous AQI</span></div>
              <div class="text-xs text-center">
                <!-- <div>Frackville Subjekt 15</div> -->
              </div>
            </div>
          </div>
            </div>

          <!-- Chart type change -->
          <div class="flex justify-end">
            <button onclick="chartTypeChanged(event)" class="bg-gray-200 text-gray-700 font-medium py-1 px-3 text-sm  rounded-l hover:bg-gray-300 focus:outline-none focus:shadow-outline chartTypes">Line</button>
            <button onclick="chartTypeChanged(event)" class="bg-gray-200 text-gray-700 font-medium py-1 px-3 text-sm  rounded-l hover:bg-gray-300 focus:outline-none focus:shadow-outline chartTypes">Scatter</button>
            <button onclick="chartTypeChanged(event)" class="bg-gray-200 text-gray-700 font-medium py-1 px-3 text-sm  rounded-r hover:bg-gray-300 focus:outline-none focus:shadow-outline chartTypes">Bar</button>
          </div>

    <!-- Charts -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6" id="allCharts">
        <div class="p-4 shadow rounded-lg bg-white">
          <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">NO2</h2>
          <div><canvas id="no2Chart" class="chartsCanvas"></canvas></div>
          <div id="no2Correlation"></div>
        </div>
        <div class="p-4 shadow rounded-lg bg-white">
            <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">PM2.5</h2>
            <div><canvas id="particulatepm2_5Chart" class="chartsCanvas"></canvas></div>
            <div id="particulatepm2_5Correlation"></div>
        </div>
        <div class="p-4 shadow rounded-lg bg-white">
            <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">PM10</h2>
            <div><canvas id="particulatepm10Chart" class="chartsCanvas"></canvas></div>
            <div id="particulatepm10Correlation"></div>
        </div>
        
    </div>


<!--Place map right next to graph-->
<!-- Map -->
<div id="map" class="z-0"></div>
{% endblock %}
