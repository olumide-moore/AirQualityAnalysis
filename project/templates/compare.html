{% extends 'base.html' %}

{% load static %}

{% block title %}Welcome{% endblock %}

{% block content %}


<div class="mx-auto px-10 sm:px-6 lg:px-10 py-20">
  {% include 'inputs.html' %}
  <div class="flex px-20 py-5 justify-between">
   
    <!-- Corrlation container -->
    <div
      class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 lg:pt-20 gap-8 mr-32">
      <div
        class="text-black rounded-2xl shadow-lg overflow-hidden flex flex-col p-6 space-y-4 w-52 h-32  bg-gray-300">
        <div class="font-bold text-4xl">
          <span id="no2correlation" class="text-lg"></span>
        </div>
        <div class="text-md">NO2 correlation</div>
      </div>

      <!-- PM2.5 correlation -->
      <div
        class="text-black rounded-2xl shadow-lg overflow-hidden flex flex-col p-6 space-y-4 w-52 h-32  bg-gray-300">
        <div class="font-bold text-4xl">
          <span id="pm2_5correlation" class="text-lg"></span>
        </div>
        <div class="text-md">PM2.5 correlation</div>
      </div>

      <!-- PM10 correlation -->
      <div
        class="text-black rounded-2xl shadow-lg overflow-hidden flex flex-col p-6 space-y-4 w-52 h-32  bg-gray-300">
        <div class="font-bold text-4xl">
          <span id="pm10correlation" class="text-lg"></span>
        </div>
        <div class="text-md">PM10 correlation</div>
      </div>
    </div>


     <!-- Table-->
    <div class="bg-white p-6 rounded-2xl shadow-lg">
      <!-- <div class="font-bold text-lg mb-4">INFO</div> -->
      <table class="table-auto w-full border-collapse border border-gray-300">
        <tbody class="text-sm">
          <!--INFO Header-->
          <tr>
            <td class="px-4 py-2 font-bold">INFO</td>
            <td class="px-4 py-2 font-bold">Sensor 1</td>
            <td class="px-4 py-2 font-bold">Sensor 2</td>
          </tr>
          <tr class="bg-gray-100">
            <td class="px-4 py-2">Sensor Type</td>
            <td id="table-sensorType1" class="sensorType px-4 py-2"></td>
            <td id="table-sensorType2" class="sensorType px-4 py-2"></td>
          </tr>
          <tr>
            <td class="px-4 py-2">ID</td>
            <td id="table-sensorId1" class="px-4 py-2"></td>
            <td id="table-sensorId2" class="px-4 py-2"></td>
          </tr>
          <tr class="bg-gray-100">
            <td class="px-4 py-2">Last updated</td>
            <td id="table-lastUpdated1" class="px-4 py-2"></td>
            <td id="table-lastUpdated2" class="px-4 py-2"></td>
          </tr>
          <!-- <tr>
            <td class="px-4 py-2">Aggregated missing ticks</td>
            <td class="px-4 py-2">6 mins</td>
          </tr> -->
          <tr>
            <td class="px-4 py-2">NO2</td>
            <td class="table-no2Value px-4 py-2"></td>
          </tr>
          <tr>
            <td class="px-4 py-2">PM2.5</td>
            <td class="table-pm2_5Value px-4 py-2"></td>
          </tr>
          <tr>
            <td class="px-4 py-2">PM10</td>
            <td class="table-pm10Value px-4 py-2"></td>
          </tr>
        </tbody>
      </table>
    </div>

  </div>



  <div class="flex flex-col p-5 my-10">
    <div>
      <!-- Compare trend Tabs -->
      <ul class="flex">
        <li class="mr-1">
          <button
            class="py-2 px-4 inline-block border-b-2 border-transparent chartTypeTabs"
            id="rawDataTab"
            onclick="switchChartTypeTab(event, 'RawDtaMultiLineCharts')">
            Raw Data
          </button>
        </li>
        <li class="mr-1">
          <button
            class="py-2 px-4 inline-block border-b-2 border-transparent chartTypeTabs"
            id="scatterTab"
            onclick="switchChartTypeTab(event, 'ScatterPlots')">
            Scatter Plots
          </button>
        </li>
        <li class="mr-1">
          <button
            class="py-2 px-4 inline-block border-b-2 border-transparent chartTypeTabs"
            id="hourlyTab"
            onclick="switchChartTypeTab(event, 'HourlyBoxPlots')">
            Hourly Boxplots
          </button>
      </ul>
    </div>

    <div class="bg-white">
      <!-- Raw Data Line Charts -->
      <div id="rawdataMultiLineCharts">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-5">
          <div class="p-4 border-gray-200 border-2 my-2 rounded-lg bg-white ml-2">
            <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">NO2 Data</h2>
            <div><canvas id="no2LineChart"></canvas></div>
          </div>
          <div class="p-4 border-gray-200 border-2 my-2 rounded-lg bg-white">
            <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">PM2.5 Data</h2>
            <div><canvas id="pm2_5LineChart"></canvas></div>
          </div>
          <div class="p-4 border-gray-200 border-2 my-2 rounded-lg bg-white mr-2">
            <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">PM10 Data</h2>
            <div><canvas id="pm10LineChart"></canvas></div>
          </div>
        </div>
      </div>

      <!-- Scatter plot-->
      <div id="scatterPlots">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-5">
          <div class="p-4 border-gray-200 border-2 my-2 rounded-lg bg-white ml-2">
            <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">NO2</h2>
            <div><canvas id="no2ScatterPlot"></canvas></div>
          </div>
          <div class="p-4 border-gray-200 border-2 my-2 rounded-lg bg-white">
            <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">PM2.5</h2>
            <div><canvas id="pm2_5ScatterPlot"></canvas></div>
          </div>
          <div class="p-4 border-gray-200 border-2 my-2 rounded-lg bg-white mr-2">
            <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">PM10</h2>
            <div><canvas id="pm10ScatterPlot"></canvas></div>
          </div>
        </div>
      </div>
      
      <!-- Box plot-->
      <div id="hourlyBoxPlots">
        <div class="flex flex-col space-y-4 mt-5">
          <div class="p-4 border-gray-200 border-2 my-2 rounded-lg bg-white mx-2">
            <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">NO2 Hourly Comparison</h2>
            <div><canvas id="no2BoxPlot"></canvas></div>
          </div>
          <div class="p-4 border-gray-200 border-2 my-2 rounded-lg bg-white mx-2">
            <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">PM2.5 Hourly Comparison</h2>
            <div><canvas id="pm2_5BoxPlot"></canvas></div>
          </div>
          <div class="p-4 border-gray-200 border-2 my-2 rounded-lg bg-white mx-2">
            <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">PM10 Hourly Comparison</h2>
            <div><canvas id="pm10BoxPlot"></canvas></div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Days comparison Box plot-->
  <div class="flex flex-col p-5 my-10">
    <div>
      <h2 class="text-lg font-medium leading-6 text-gray-900 mb-4 px-4 py-3 inline-block border-b-2 border-transparent hover:border-gray-300">
        Compare selected date against:
      </h2>
      <!-- Compare trend Tabs -->
      <ul class="flex">
        <li class="mr-1">
          <button
            class="py-2 px-4 inline-block border-b-2 border-transparent multiChartComparisonTabs"
            onclick="switchDaysComparisonTab(event, 'Last7Days')">
            Last 7 Days
          </button>
        </li>
        <li class="mr-1">
          <button
            class="py-2 px-4 inline-block border-b-2 border-transparent multiChartComparisonTabs"
            onclick="switchDaysComparisonTab(event, 'SameDayLast7Weeks')">
            Same day for last 7 weeks
          </button>
        </li>
      </ul>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 bg-white">
      <div class="p-4 border-gray-200 border-2 my-2 rounded-lg bg-white ml-2">
        <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">
          NO2
        </h2>
        <div>
          <canvas id="no2DaysBoxPlot"></canvas>
        </div>
      </div>
      <div class="p-4 border-gray-200 border-2 my-2 rounded-lg bg-white">
        <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">
          PM2.5
        </h2>
        <div>
          <canvas id="pm2_5DaysBoxPlot"></canvas>
        </div>
      </div>
      <div class="p-4 border-gray-200 border-2 my-2 rounded-lg bg-white mr-2">
        <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">
          PM10
        </h2>
        <div>
          <canvas id="pm10DaysBoxPlot"></canvas>
        </div>
      </div>
    </div>
  </div>

</div>
{% endblock %}

{% block scripts %}
<script type="text/javascript" src="{% static 'js/compare.js' %}"></script>
<script type="text/javascript">
  let sensorType1="{{ sensorType1|escapejs }}";
  let sensorId1="{{ sensorId1|escapejs }}";
  let date="{{ date|escapejs }}";
    document.addEventListener('DOMContentLoaded', function() {
  let sensorTypeSelect = document.getElementById("sensorTypeSelect1"); //get select of sensor type list
  if (sensorType1 !="None")  sensorTypeSelect.value = sensorType1; //set sensor type 1
  //get the type id of selected sensor type
  let selectedType = sensorTypeSelect.options[sensorTypeSelect.selectedIndex];
  let typeid1 = selectedType.getAttribute("data-id"); //get sensor type id 1
  let sensorIdSelect1 = document.getElementById("sensorIdSelect1"); //get select of sensor id list
  if (date !="None")  document.getElementById('dateInput').value = date;
  fetchSensorIDs(typeid1).then((sensorData1) => {
    populateSensorOptions(sensorIdSelect1, sensorData1); //populate sensor ids of first sensor list
    if (sensorId1 !="None")   sensorIdSelect1.value = `${sensorId1}`; //set sensor id 1
    sensorTypeChanged(2);
  });
  });
</script>
{% endblock %}