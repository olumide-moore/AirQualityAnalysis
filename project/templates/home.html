{% extends 'base.html' %}

{% block title %}Welcome{% endblock %}

{% block content %}


<div class="mx-auto px-10 sm:px-6 lg:px-10 py-20">
  <div class="flex gap-2 my-4">
    <!-- Sensor selection dropdown -->
    <div>
      <label for="sensortype" class="block text-sm font-medium text-gray-700"
        >Sensor Type:</label
      >
      <select
        id="sensortype"
        name="sensortype"
        class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
        onchange="fetchSensorIDs()"
      >
        {% if sensor_types %} {% for id, sensor_type in sensor_types.items %}
        <option value="{{ sensor_type }}" data-id="{{ id }}">
          {{ sensor_type }}
        </option>
        {% endfor %} {% endif %}
      </select>
    </div>
    <div>
      <label for="sensorid" class="block text-sm font-medium text-gray-700"
        >Sensor ID:</label
      >
      <select
        id="sensorid"
        name="sensorid"
        class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
        onchange="fetchData()"
      ></select>
    </div>
    <!--Period filter change-->
    <div class="ml-20">
      <label for="period" class="block text-sm font-medium text-gray-700"
        >Period:</label
      >
      <select
        id="period"
        name="period"
        class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
        onchange="fetchData()"
      >
        <!-- <option value="1">1 hour</option> -->
        <!-- <option value="6">6 hours</option> -->
        <!-- <option value="12">12 hours</option> -->
        <option value="24">Last 24 hours</option>
        <!-- <option value="48">48 hours</option> -->
        <!-- <option value="72">72 hours</option> -->
      </select>
      <!-- Date Filter Input -->
      <input
        type="date"
        id="dateFilter"
        class="px-4 shadow-lg border border-gray-300 rounded focus:outline-none focus:border-indigo-500 focus:shadow-outline-indigo"
        onchange="fetchData()"
      />
    </div>
  </div>

  <div class="flex p-5 gap-4 bg-white">
    <!-- Table-->
    <div class="bg-white p-6 rounded-2xl shadow-lg">
      <!-- <div class="font-bold text-lg mb-4">INFO</div> -->
      <table class="table-auto w-full border-collapse border border-gray-300">
        <tbody class="text-sm">
          <!--INFO Header-->
          <tr>
            <td class="px-4 py-2 font-bold">INFO</td>
          </tr>
          <tr class="bg-gray-100">
            <td class="px-4 py-2">Sensor Type</td>
            <td id="sensorType" class="sensorType px-4 py-2"></td>
          </tr>
          <tr>
            <td class="px-4 py-2">ID</td>
            <td id="sensorId" class="px-4 py-2"></td>
          </tr>
          <tr class="bg-gray-100">
            <td class="px-4 py-2">Last updated</td>
            <td id="lastUpdated" class="px-4 py-2"></td>
          </tr>
          <!-- <tr>
            <td class="px-4 py-2">Aggregated missing ticks</td>
            <td class="px-4 py-2">6 mins</td>
          </tr> -->
          <tr>
            <td class="px-4 py-2">NO2</td>
            <td class="no2Value px-4 py-2"></td>
          </tr>
          <tr>
            <td class="px-4 py-2">PM2.5</td>
            <td class="pm2_5Value px-4 py-2"></td>
          </tr>
          <tr>
            <td class="px-4 py-2">PM10</td>
            <td class="pm10Value px-4 py-2"></td>
          </tr>
        </tbody>
      </table>
    </div>
    <!-- Card container -->
    <div
      class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 lg:pt-20 gap-8"
      id="kub=="
    >
      <!-- <div class="flex space-x-4"> -->
      <!-- NO2 card-->
      <div
        class="text-white rounded-2xl shadow-lg overflow-hidden flex flex-col p-6 space-y-4 w-52 h-40"
        id="no2card"
      >
        <div class="text-xs">The highest average NO2</div>
        <div class="no2Value font-bold text-4xl">
          <span class="text-lg">Unhealthy AQI</span>
        </div>
        <div class="flex justify-between text-xs">
          <div class="text-center">
            <div>Dominant pollutant</div>
            <div>☀️ NO2</div>
          </div>
        </div>
      </div>

      <!-- PM2.5 card -->
      <div
        class="text-white rounded-2xl shadow-lg overflow-hidden flex flex-col p-6 space-y-4 w-52 h-40"
        id="pm2_5card"
      >
        <div class="text-xs">The lowest average pollution</div>
        <div class="pm2_5Value font-bold text-4xl">
          <span class="text-lg">Healthy AQI</span>
        </div>
        <div class="text-xs text-center">
          <div>PM2.5</div>
        </div>
      </div>

      <!-- PM10 card -->
      <div
        class="text-white rounded-2xl shadow-lg overflow-hidden flex flex-col p-6 space-y-4 w-52 h-40"
        id="pm10card"
      >
        <div class="text-xs">The highest average pollution</div>
        <div class="pm10Value font-bold text-4xl">
          <span class="text-lg">Hazardous AQI</span>
        </div>
        <div class="text-xs text-center">
          <div>PM10</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Hourly averages bars-->
  <div
    class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-5"
    id="lineCharts"
  >
    <div class="p-4 shadow rounded-lg bg-white">
      <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">
        NO2 Hourly averages
      </h2>
      <div><canvas id="no2HourlyAvgChart" class="chartsCanvas"></canvas></div>
    </div>
    <div class="p-4 shadow rounded-lg bg-white">
      <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">
        PM2.5 Hourly averages
      </h2>
      <div><canvas id="pm2_5HourlyAvgChart" class="chartsCanvas"></canvas></div>
    </div>
    <div class="p-4 shadow rounded-lg bg-white">
      <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">
        PM10 Hourly averages
      </h2>
      <div><canvas id="pm10HourlyAvgChart" class="chartsCanvas"></canvas></div>
    </div>
  </div>

  <!-- Minutely Line Charts -->
  <div
    class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-5"
    id="lineCharts">
    <div class="p-4 shadow rounded-lg bg-white">
      <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">NO2 Data</h2>
      <div><canvas id="no2LineChart" class="chartsCanvas"></canvas></div>
    </div>
    <div class="p-4 shadow rounded-lg bg-white">
      <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">PM2.5 Data</h2>
      <div><canvas id="pm2_5LineChart" class="chartsCanvas"></canvas></div>
    </div>
    <div class="p-4 shadow rounded-lg bg-white">
      <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">PM10 Data</h2>
      <div><canvas id="pm10LineChart" class="chartsCanvas"></canvas></div>
    </div>
  </div>

  <div class="flex flex-col p-5 my-10 gap-4 bg-white">
    <div class="border-b border-gray-200">
      <h2 class="text-lg font-medium leading-6 text-gray-900 mb-4 px-4 py-3 inline-block border-b-2 border-transparent hover:border-gray-300">
        Compare selected date against:
      </h2>
      <!-- Compare trend Tabs -->
      <ul class="flex">
        <li class="mr-1">
          <button
            class="py-2 px-4 inline-block hover:text-blue-500 hover:border-blue-500 border-b-2 border-transparent multiChartCompoarisonTabs"
            onclick="switchDaysComparisonTab(event, 'Last7Days')">
            Last 7 Days
          </button>
        </li>
        <li class="mr-1">
          <button
            class="py-2 px-4 inline-block hover:text-blue-500 hover:border-blue-500 border-b-2 border-transparent multiChartCompoarisonTabs"
            onclick="switchDaysComparisonTab(event, 'SameDayLast7Weeks')">
            Same day for last 7 weeks
          </button>
        </li>
      </ul>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-5">
      <div class="p-4 shadow rounded-lg bg-white">
        <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">
          NO2 Comparison
        </h2>
        <div>
          <canvas id="no2ComparisonMultiChart" class="chartsCanvas"></canvas>
        </div>
      </div>
      <div class="p-4 shadow rounded-lg bg-white">
        <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">
          PM2.5 Comparison
        </h2>
        <div>
          <canvas id="pm2_5ComparisonMultiChart" class="chartsCanvas"></canvas>
        </div>
      </div>
      <div class="p-4 shadow rounded-lg bg-white">
        <h2 class="text-sm font-medium leading-6 text-gray-900 mb-4">
          PM10 Comparison
        </h2>
        <div>
          <canvas id="pm10ComparisonMultiChart" class="chartsCanvas"></canvas>
        </div>
      </div>
    </div>
  </div>

  <!-- Map -->
  <div id="map" class="z-0"></div>
</div>
{% endblock %}
